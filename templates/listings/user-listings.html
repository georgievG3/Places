{% extends 'common/base.html' %}
{% block content %}
    <div class="user-listings">
        {% if listings %}
            <h1>МОИТЕ ОБЯВИ:</h1>
            {% for listing in listings %}
                <div class='user-listing-card'>
                    <a href="{% url 'edit-listing' listing.slug %}" class = 'listing-buttons listing-edit'><i class="fa-solid fa-pen-to-square"></i></a>
                    <a href="{% url 'delete-listing' listing.slug %}" class = 'listing-buttons listing-delete'><i class="fa-solid fa-trash"></i></a>
                    <img src="{{ listing.images.first.image.url }}" alt="">
                    <div class="user-listing-card-containers">
                        <div class="user-listing-card-title-container">
                            <div class="listing-card-info">
                                <a href="{% url 'listing-detail' listing.slug %}"><h3>{{ listing.title }}</h3></a>
                                <p class="listing-card-category">{{ listing.type }}</p>
                            </div>
                        </div>
                        <div class="user-listing-card-info-container">
                            <div class="listing-card-info">
                                <p>Активна</p>
                                {% if listing.is_approved %}
                                    <p><i class="fa-solid fa-check" style="color: green"></i></p>
                                {% else %}
                                    <p><i class="fa-solid fa-xmark" style="color: red"></i></p>
                                {% endif %}
                            </div>
                            <div class='listing-card-info'>
                                <p>Разглеждания</p>
                                <p>0</p>
                            </div>
                            <div class='listing-card-info'>
                                <p>Харесвания</p>
                                <p>{{ listing.likes.count }}</p>
                            </div>
                            <div class='listing-card-info'>
                                <p>Рейтинг</p>
                                <div class="review-date-rating">
                                    <p class="review-rating">
                                        {% for i in "12345"|make_list %}
                                            {% if forloop.counter <= listing.avg_rating %}
                                                <i class="fa-solid fa-star"></i>
                                            {% else %}
                                                <i class="fa-regular fa-star"></i>
                                            {% endif %}
                                        {% endfor %}
                                        <span class="rating-value">({{ listing.avg_rating|floatformat:1|default:0 }})</span>
                                    </p>
                                </div>
                            </div>
                            <div class='listing-card-info'>
                                <p>Ревюта</p>
                                <p>{{ listing.comments.count }}</p>
                            </div>
                        </div>
                    </div>
                </div>
            {% endfor %}
         {% else %}
            <h1>Нямате качени обяви!</h1>
        {% endif %}
    </div>
{% endblock %}